package org.webfreak.plott3r;

import org.webfreak.plott3r.device.Board;
import org.webfreak.plott3r.device.Pen;

import lejos.hardware.Sound;
import lejos.hardware.motor.Motor;
import lejos.hardware.port.SensorPort;
import lejos.hardware.sensor.EV3ColorSensor;
import lejos.hardware.sensor.EV3TouchSensor;
import lejos.robotics.RegulatedMotor;
import lejos.utility.Delay;

public class Main {
	public static void main(String[] args) {
		EV3TouchSensor debugButton = new EV3TouchSensor(SensorPort.S1);

		float[] sample = new float[1];
		Motor.D.setSpeed(15);
		Motor.D.forward();
		while (true) {
			debugButton.getTouchMode().fetchSample(sample, 0);
			if (sample[0] < 0.5f)
				break;
		}
		Motor.D.flt();

		Pen pen = new Pen(Motor.C, Motor.D, new EV3TouchSensor(SensorPort.S3));
		pen.reset();

		Board board = new Board(Motor.A, new EV3ColorSensor(SensorPort.S2));
		board.pullInPaper();
		board.resetCoordinates();
		
		Canvas canvas = new Canvas(pen, board);
		// canvas.drawPath(
		// "M12,21.35L10.55,20.03C5.4,15.36 2,12.27 2,8.5C2,5.41 4.42,37.5,3C9.24,3
		// 10.91,3.81 12,5.08C13.09,3.81 14.76,3 16.5,3C19.58,3 22,5.4122,8.5C22,12.27
		// 18.6,15.36 13.45,20.03L12,21.35Z");
		
		//canvas.translate(1, 2);
		//canvas.scale(2);
		//canvas.moveTo(1, 1);
		//canvas.lineTo(8, 1);
		//canvas.moveTo(1, 1);
		//canvas.lineTo(1, 8);
		//canvas.moveTo(1, 1);
		//canvas.lineTo(6, 6);

		canvas.scale(18 / 24.0);
		canvas.moveTo(12, 21.35);
		canvas.lineTo(10.55, 20.03);
		canvas.bezierTo(5.4, 15.36, 2, 12.27, 2, 8.5);
		canvas.bezierTo(2, 5.41, 4.42, 3, 7.5, 3);
		canvas.bezierTo(9.24, 3, 10.91, 3.81, 12, 5.08);
		canvas.bezierTo(13.09, 3.81, 14.76, 3, 16.5, 3);
		canvas.bezierTo(19.58, 3, 22, 5.41, 22, 8.5);
		canvas.bezierTo(22, 12.27, 18.6, 15.36, 13.45, 20.03);
		canvas.lineTo(12, 21.35);

		//canvas.translate(0, -291.70835);
		//canvas.scale(18 / 24.0);
		//canvas.drawPath("m 1.4998529,303.70715 c -0.331796,-2.00001 -0.66863669,-4.84776 0.9999019,-5.99938 2.0980382,-1.4481 4.9503365,1.45872 7.4992649,1.49983 2.0271253,0.034 4.7730143,-2.61427 5.9994123,-0.99989 1.668691,2.1966 -5.432219,5.53081 -3.499657,7.49926 1.149857,1.1712 1.762349,-3.07523 3.001226,-1.99862 1.831513,1.59167 0.761888,5.62158 -1.5,6.5 -2.371274,0.92087 -4.3721172,-1.22179 -5.5008343,-3.50149 -0.7431353,-1.5009 1.8628033,-4.02602 0.4999509,-4.99949 -3.4996569,-2.49977 -2.5954416,2.47822 -2.999706,4.49954 -0.4999509,2.49977 0.3636989,3.82901 -0.9999021,3.9996 -2.4415232,0.30536 -3.0969688,-4.07197 -3.4996566,-6.49936 z m 14.9969781,-9.72484 c 0,0.036 -0.01085,0.065 -0.03254,0.0869 -0.02411,0.0265 -0.05424,0.0421 -0.09038,0.0469 l -0.383209,0.034 -0.162681,0.99056 c -0.01205,0.0627 -0.06025,0.0989 -0.144606,0.10846 -0.07713,0 -0.115688,-0.0385 -0.115688,-0.11564 l 0.159069,-0.96165 -0.339826,0.034 c -0.02893,0 -0.05664,-0.0132 -0.08315,-0.0397 -0.02411,-0.0201 -0.03857,-0.0467 -0.04338,-0.0798 0,-0.0433 0.0096,-0.0758 0.02891,-0.0975 0.02169,-0.0252 0.05061,-0.0384 0.08676,-0.0397 l 0.394054,-0.0302 0.07953,-0.53868 c 0.01204,-0.0675 0.05542,-0.10129 0.130146,-0.10129 0.02892,0 0.05784,0.0113 0.08676,0.034 0.02411,0.0265 0.03617,0.059 0.03617,0.0975 l -0.0723,0.48078 0.343443,-0.0302 c 0.02651,0 0.05302,0.0101 0.07953,0.0302 0.02411,0.0227 0.03857,0.054 0.04338,0.0941 z m -1.367149,0.0378 c 0,0.0675 -0.02169,0.11085 -0.06507,0.13 -0.02892,0.0151 -0.07471,0.0227 -0.137376,0.0227 -0.221731,0 -0.429001,0.0784 -0.62181,0.23506 -0.144606,0.11565 -0.232575,0.22172 -0.263907,0.31821 l -0.06507,0.42757 c -0.0097,0.0627 -0.05424,0.0941 -0.13376,0.0941 -0.07471,0 -0.118096,-0.0409 -0.130147,-0.12282 l 0.184374,-1.10624 c 0.01204,-0.0771 0.05422,-0.11564 0.12653,-0.11564 0.08435,0 0.12653,0.0457 0.12653,0.13719 l -0.03254,0.20256 c 0.132557,-0.12295 0.256679,-0.20495 0.372364,-0.24602 0.147017,-0.0529 0.31452,-0.0794 0.502508,-0.0794 0.09159,0 0.137377,0.0338 0.137377,0.10128 z m -1.498101,0.423 c 0,0.22423 -0.0723,0.41101 -0.216909,0.56034 -0.144605,0.1494 -0.341029,0.2241 -0.589272,0.2241 -0.185579,0 -0.328981,-0.0639 -0.430206,-0.1916 -0.08676,-0.11085 -0.130147,-0.25546 -0.130147,-0.43381 0,-0.18317 0.06748,-0.34344 0.20245,-0.48082 0.154248,-0.15898 0.353083,-0.23847 0.596504,-0.23847 0.183168,0 0.327775,0.0615 0.433821,0.18442 0.08917,0.10607 0.133759,0.23142 0.133759,0.37603 z m -0.245831,0.0435 c 0,-0.0892 -0.02651,-0.16754 -0.07954,-0.23506 -0.06507,-0.0796 -0.162683,-0.11942 -0.292828,-0.11942 -0.137375,0 -0.25547,0.0506 -0.354285,0.15192 -0.08676,0.0892 -0.130147,0.19047 -0.130147,0.30384 0,0.25305 0.115685,0.37958 0.347056,0.37958 0.139786,0 0.259086,-0.0482 0.357901,-0.14474 0.101226,-0.0965 0.151839,-0.20861 0.151839,-0.33634 z m -1.206875,-0.13718 c 0,0.20962 -0.10725,0.40364 -0.32175,0.58207 -0.204861,0.1688 -0.414541,0.2532 -0.62904,0.2532 -0.02651,0 -0.05061,-0.0132 -0.0723,-0.0397 -0.02411,-0.0252 -0.03617,-0.0529 -0.03617,-0.0831 0,-0.0867 0.03615,-0.13001 0.108454,-0.13001 0.178349,0 0.342237,-0.0736 0.491664,-0.2207 0.132555,-0.13 0.198833,-0.26014 0.198833,-0.39042 0,-0.13505 -0.05182,-0.20257 -0.155452,-0.20257 -0.07712,0 -0.200039,0.0314 -0.368748,0.0941 -0.183168,0.0723 -0.279573,0.13744 -0.289215,0.19539 l -0.303674,1.80398 c -0.01205,0.0627 -0.06386,0.0941 -0.155452,0.0941 -0.03133,0 -0.05784,-0.0169 -0.07953,-0.0506 -0.01927,-0.029 -0.02891,-0.0615 -0.02891,-0.0975 l 0.375977,-2.17998 c 0.01204,-0.0602 0.02771,-0.10001 0.047,-0.11942 0.02169,-0.0227 0.05785,-0.034 0.108454,-0.034 0.07712,0 0.113274,0.0314 0.108454,0.0941 l -0.0072,0.11942 c 0.190399,-0.11337 0.369953,-0.17006 0.53866,-0.17006 0.115685,0 0.21209,0.0253 0.289215,0.076 0.120505,0.0796 0.180757,0.21458 0.180757,0.4049 z m -1.563038,0.57844 c 0,0.0892 -0.110865,0.16993 -0.332596,0.24224 -0.183169,0.0579 -0.3338009,0.0869 -0.4518969,0.0869 -0.378388,0 -0.567582,-0.16509 -0.567582,-0.49526 0,-0.21213 0.072303,-0.40495 0.216909,-0.57844 0.1638873,-0.20004 0.366337,-0.30006 0.6073489,-0.30006 0.154248,0 0.278368,0.0314 0.372361,0.0941 0.09399,0.0627 0.140993,0.13378 0.140993,0.21315 0,0.14461 -0.142197,0.29042 -0.426591,0.43743 -0.2386006,0.12295 -0.4012829,0.18443 -0.4880469,0.18443 -0.067483,0 -0.101225,-0.0409 -0.101225,-0.12283 0,-0.0265 0.126531,-0.0916 0.379593,-0.19538 0.2554719,-0.10607 0.3832079,-0.19399 0.3832079,-0.26378 0,-0.029 -0.01928,-0.0556 -0.05784,-0.0797 -0.04338,-0.0177 -0.110863,-0.0265 -0.202449,-0.0265 -0.1807572,0 -0.3241592,0.0639 -0.4302059,0.1916 -0.096404,0.11817 -0.144606,0.26398 -0.144606,0.43744 0,0.0844 0.0241,0.14953 0.0723,0.19538 0.0482,0.0459 0.125324,0.0688 0.231372,0.0688 0.1205047,0 0.2325739,-0.0241 0.3362089,-0.0722 l 0.347056,-0.1625 c 0.07713,0 0.115687,0.0482 0.115687,0.14474 z m -1.4570913,-1.59069 c 0,0.19753 -0.084353,0.37107 -0.2530602,0.52062 -0.2000385,0.18064 -0.5157635,0.30957 -0.9471749,0.38679 0.2458319,0.20735 0.4892535,0.37607 0.7302647,0.50615 0.2988545,0.16376 0.4482818,0.26983 0.4482818,0.3182 0,0.0965 -0.049407,0.14475 -0.1482225,0.14475 -0.069894,0 -0.2253467,-0.0734 -0.4663571,-0.22033 -0.2988545,-0.18089 -0.6133745,-0.41467 -0.9435598,-0.70134 l -0.065073,0.33257 c -0.021692,0.12043 -0.055434,0.29274 -0.1012248,0.51695 -0.021693,0.0867 -0.069895,0.13 -0.1446058,0.13 -0.086765,0 -0.1301467,-0.053 -0.1301467,-0.1591 0,-0.0101 0.028921,-0.16432 0.086762,-0.46276 l 0.065073,-0.33634 -0.1662982,0.0113 c -0.036151,0.003 -0.067483,-0.01 -0.093995,-0.0378 -0.021693,-0.029 -0.034949,-0.0591 -0.039768,-0.0903 0,-0.0627 0.025307,-0.10607 0.07592,-0.13 0.053021,-0.0265 0.1446055,-0.0397 0.2747525,-0.0397 l 0.1048415,-0.69053 c 0.019274,-0.0723 0.061451,-0.10846 0.1265301,-0.10846 0.098815,0 0.1482225,0.0482 0.1482225,0.14474 0,0.0771 -0.015666,0.20362 -0.046998,0.37958 l -0.039768,0.2532 c 0.2410122,0 0.4928692,-0.0518 0.7555711,-0.15532 0.3277757,-0.13001 0.4916635,-0.30113 0.4916635,-0.51336 0,-0.10355 -0.081943,-0.18065 -0.2458306,-0.23129 -0.1060458,-0.0337 -0.230166,-0.0506 -0.3723607,-0.0506 -0.2819837,0 -0.5181749,0.0338 -0.7085738,0.10128 l -0.6507311,0.23129 c -0.040971,0 -0.069893,-0.0126 -0.086766,-0.0378 -0.01688,-0.0265 -0.026517,-0.0578 -0.028911,-0.0941 -0.00241,-0.0602 0.028918,-0.10593 0.093995,-0.13719 0.1952189,-0.094 0.4169493,-0.17233 0.6651913,-0.23506 0.2675228,-0.0698 0.4988937,-0.10468 0.6941128,-0.10468 0.2410123,0 0.4398467,0.0338 0.5965032,0.10128 0.2145001,0.094 0.3217502,0.24581 0.3217502,0.4555 z m -4.2867952,0.68327 -1.0881671,2.19082 c -0.024111,0.0481 -0.067494,0.0722 -0.1301468,0.0722 -0.026512,0 -0.051819,-0.0132 -0.07592,-0.0397 -0.024111,-0.0252 -0.036167,-0.0601 -0.036167,-0.10468 0,-0.0265 0.018076,-0.0759 0.054227,-0.14814 l 0.383208,-0.75557 C 3.8367874,294.86905 3.703026,294.57985 3.5777005,294.36776 l -0.2096792,-0.36885 c 0,-0.0867 0.045792,-0.13 0.1373763,-0.13 0.053021,0 0.1530406,0.12653 0.3000578,0.37958 0.074714,0.13252 0.1337621,0.24337 0.1771444,0.33256 0.048202,0.0988 0.098814,0.21202 0.1518353,0.33975 l 0.4988939,-0.99418 c 0.01688,-0.0481 0.065082,-0.0722 0.1446058,-0.0722 0.062663,0 0.093995,0.0554 0.093995,0.16629 z m -1.6777294,1.11349 c 0,0.0338 -0.01446,0.0652 -0.043381,0.0941 -0.028921,0.029 -0.060252,0.0435 -0.093995,0.0435 -0.060253,0 -0.1036347,-0.0314 -0.130146,-0.0941 -0.1084551,-0.25069 -0.1976294,-0.5375 -0.2675227,-0.86044 -0.031331,-0.15671 -0.059048,-0.33505 -0.083149,-0.53502 -0.019281,-0.18089 -0.028922,-0.35563 -0.028922,-0.52421 -0.1325563,0.17107 -0.2627025,0.36629 -0.3904385,0.58566 l -0.2783681,0.46998 c -0.069893,0.12043 -0.1132755,0.18303 -0.1301464,0.18782 -0.079534,0 -0.1675028,-0.12169 -0.2639075,-0.36507 -0.079534,-0.20004 -0.1530421,-0.46876 -0.2205253,-0.80617 l -0.1988346,0.33635 c -0.1156854,0.19752 -0.22052537,0.40357 -0.3145199,0.61816 -0.13255633,0.29885 -0.23137107,0.58446 -0.2964442,0.85681 -0.009639,0.0411 -0.02651,0.0676 -0.050612,0.0797 -0.02169,0.0151 -0.0530213,0.0227 -0.093994,0.0227 -0.0265113,0 -0.0566377,-0.0113 -0.090379,-0.034 -0.0216899,-0.0201 -0.0349455,-0.0502 -0.039767,-0.0903 0,-0.16377 0.10122483,-0.46624 0.3036745,-0.90742 0.16147773,-0.35428 0.31331493,-0.64952 0.4555116,-0.88572 0.2072699,-0.34221 0.3591071,-0.51332 0.4555117,-0.51332 0.045792,0 0.1000196,0.18799 0.1626827,0.56396 0.043382,0.25069 0.1024299,0.45795 0.1771436,0.62179 0.1735283,-0.33017 0.3771829,-0.62903 0.610964,-0.89657 0.2000395,-0.22902 0.3338009,-0.34353 0.4012841,-0.34353 0.053023,0 0.079534,0.17593 0.079534,0.5278 0,0.27475 0.031332,0.56397 0.093995,0.86766 0.045792,0.21919 0.1048397,0.44333 0.1771432,0.67242 z M 15.298073,311.7084 h 1.499854 v -1.49987 M 0,310.20651 v 1.49987 H 1.4998529 M 15.298073,291.70835 h 1.499853 v 1.49987 M 0,293.20822 v -1.49987 h 1.4998529");

		pen.stopWrite();

		Sound.twoBeeps();
	}
}
