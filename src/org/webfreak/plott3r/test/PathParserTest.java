package org.webfreak.plott3r.test;

import static org.junit.Assert.*;

import org.junit.Test;
import org.webfreak.plott3r.svg.path.Path;
import org.webfreak.plott3r.svg.path.PathParser;
import org.webfreak.plott3r.svg.path.PathSeg;
import org.webfreak.plott3r.svg.path.PathSegClosePath;
import org.webfreak.plott3r.svg.path.PathSegLinetoAbs;
import org.webfreak.plott3r.svg.path.PathSegMovetoAbs;

public class PathParserTest {
	@Test
	public void testNumbers() {
		PathParser p = new PathParser().feed("6.03");
		assertEquals(p.parseCoordinate(), 6.03, 0.01);
	}

	@Test
	public void testLine() {
		Path path = new PathParser().feed("M 100 100 L 300 100 L 200 300 z").build();

		assertEquals(path.getPathSegCount(), 4);
		assertTrue(path.getPathSegList().get(0) instanceof PathSegMovetoAbs);
		assertEquals(path.getPathSegList().get(0).getPathSegType(), PathSeg.PATHSEG_MOVETO_ABS);
		assertTrue(path.getPathSegList().get(1) instanceof PathSegLinetoAbs);
		assertEquals(path.getPathSegList().get(1).getPathSegType(), PathSeg.PATHSEG_LINETO_ABS);
		assertTrue(path.getPathSegList().get(2) instanceof PathSegLinetoAbs);
		assertEquals(path.getPathSegList().get(2).getPathSegType(), PathSeg.PATHSEG_LINETO_ABS);
		assertTrue(path.getPathSegList().get(3) instanceof PathSegClosePath);
		assertEquals(path.getPathSegList().get(3).getPathSegType(), PathSeg.PATHSEG_CLOSEPATH);
	}

	@Test
	public void testArch() {
		Path path = new PathParser().feed(
				"M12,2C11.11,4.18 10.57,5.61 9.58,7.73C10.19,8.37 10.93,9.12 12.14,9.97C10.84,9.43 9.95,8.9 9.29,8.34C8,11 6.03,14.75 2,22C5.17,20.17 7.63,19.04 9.92,18.61C9.82,18.19 9.76,17.73 9.77,17.25V17.15C9.82,15.12 10.88,13.56 12.13,13.67C13.38,13.77 14.35,15.5 14.3,17.54C14.29,17.92 14.25,18.29 14.18,18.63C16.44,19.07 18.87,20.19 22,22C21.38,20.86 20.83,19.84 20.31,18.87C19.5,18.23 18.61,17.39 16.85,16.5C18.06,16.8 18.93,17.16 19.61,17.57C14.26,7.62 13.83,6.3 12,2Z")
				.build();
	}

	@Test
	public void testComplex() {
		Path path = new PathParser().feed(
				"m 0.39687457,294.88334 c -0.0877962,-0.52922 -0.17692728,-1.28276 0.26458305,-1.58749 0.55515978,-0.38318 1.30990358,0.38599 1.98437298,0.39687 0.5363956,0.009 1.2629825,-0.69176 1.5874984,-0.26458 0.4415507,0.58124 -1.4374139,1.4635 -0.9260407,1.98437 0.3042626,0.30991 0.8628056,-0.81405 1.1906235,-0.52917 0.484635,0.42117 0.06935,1.61965 -0.5291661,1.85209 -0.6274603,0.24367 -1.421121,-0.45511 -1.7197897,-1.05834 -0.1966403,-0.39715 0.4929146,-1.06532 0.1322915,-1.32291 -0.9260407,-0.66146 -0.6867772,0.65576 -0.7937492,1.19062 -0.1322915,0.66146 0.096238,1.01319 -0.2645831,1.05833 -0.646049,0.0808 -0.8194858,-1.07748 -0.92604063,-1.71979 z m 4.18002413,-2.57328 q 0,0.0143 -0.00861,0.023 -0.00957,0.0105 -0.023915,0.0124 l -0.1014004,0.009 -0.043047,0.26211 q -0.00478,0.0249 -0.038264,0.0287 -0.030612,0 -0.030612,-0.0306 l 0.042091,-0.25446 -0.089921,0.009 q -0.01148,0 -0.022002,-0.0105 -0.00957,-0.008 -0.011479,-0.0211 0,-0.0172 0.00765,-0.0258 0.00861,-0.01 0.022958,-0.0105 l 0.1042702,-0.008 0.021045,-0.14254 q 0.00478,-0.0268 0.034438,-0.0268 0.011479,0 0.022958,0.009 0.00957,0.0105 0.00957,0.0258 l -0.019132,0.12722 0.090878,-0.008 q 0.010523,0 0.021045,0.008 0.00957,0.009 0.011479,0.0249 z m -0.36176,0.01 q 0,0.0268 -0.017219,0.0344 -0.011479,0.006 -0.036351,0.006 -0.088008,0 -0.1645366,0.0622 -0.057396,0.0459 -0.069832,0.0842 L 3.909981,292.62 q -0.00383,0.0249 -0.035394,0.0249 -0.029655,0 -0.034438,-0.0325 l 0.048787,-0.29272 q 0.00478,-0.0306 0.033481,-0.0306 0.033481,0 0.033481,0.0363 l -0.00861,0.0536 q 0.052614,-0.0488 0.098531,-0.0651 0.058353,-0.021 0.1329682,-0.021 0.036351,0 0.036351,0.0268 z m -0.3964109,0.11193 q 0,0.089 -0.057396,0.14827 -0.057396,0.0593 -0.1559268,0.0593 -0.073659,0 -0.1138363,-0.0507 -0.034438,-0.044 -0.034438,-0.11479 0,-0.0727 0.05357,-0.12723 0.061223,-0.0631 0.1578403,-0.0631 0.072702,0 0.1147929,0.0488 0.035394,0.0421 0.035394,0.0995 z m -0.065049,0.0115 q 0,-0.0354 -0.021046,-0.0622 -0.025828,-0.0316 -0.077485,-0.0316 -0.054526,0 -0.093747,0.0402 -0.034438,0.0354 -0.034438,0.0804 0,0.10044 0.091834,0.10044 0.055483,0 0.094704,-0.0383 0.040178,-0.0383 0.040178,-0.089 z m -0.31935,-0.0363 q 0,0.0832 -0.085138,0.15402 -0.081312,0.067 -0.1664498,0.067 -0.010523,0 -0.019132,-0.0105 -0.00957,-0.01 -0.00957,-0.022 0,-0.0344 0.028698,-0.0344 0.070789,0 0.1300987,-0.0584 0.052613,-0.0516 0.052613,-0.10331 0,-0.0536 -0.041134,-0.0536 -0.030611,0 -0.097574,0.0249 -0.072702,0.0287 -0.076529,0.0517 l -0.080355,0.47735 q -0.00478,0.0249 -0.041134,0.0249 -0.012436,0 -0.021045,-0.0134 -0.00765,-0.0115 -0.00765,-0.0258 l 0.099487,-0.57684 q 0.00478,-0.0239 0.012436,-0.0316 0.00861,-0.009 0.028698,-0.009 0.030611,0 0.028698,0.0249 l -0.00191,0.0316 q 0.075572,-0.045 0.1425342,-0.045 0.045917,0 0.076529,0.0201 0.04783,0.0316 0.04783,0.10714 z m -0.26498,-0.11288 z m -0.148614,0.26594 q 0,0.0354 -0.088008,0.0641 -0.072702,0.023 -0.1195758,0.023 -0.1501873,0 -0.1501873,-0.13105 0,-0.0842 0.057396,-0.15306 0.065049,-0.0794 0.16071,-0.0794 0.061223,0 0.09853,0.0249 0.037308,0.0249 0.037308,0.0564 0,0.0574 -0.1128797,0.11575 -0.094704,0.0488 -0.1291418,0.0488 -0.026785,0 -0.026785,-0.0325 0,-0.0105 0.1004439,-0.0517 0.1014002,-0.0421 0.1014002,-0.0698 0,-0.0115 -0.015306,-0.0211 -0.017219,-0.007 -0.05357,-0.007 -0.071745,0 -0.1138362,0.0507 -0.038264,0.0469 -0.038264,0.11575 0,0.0335 0.019132,0.0517 0.019132,0.0182 0.061223,0.0182 0.04783,0 0.088964,-0.0191 l 0.091834,-0.043 q 0.030612,0 0.030612,0.0383 z m -0.3855595,-0.42091 q 0,0.0784 -0.066962,0.13776 -0.079398,0.0717 -0.250631,0.10235 0.097574,0.0823 0.1932346,0.13393 0.1186194,0.065 0.1186194,0.0842 0,0.0383 -0.039221,0.0383 -0.027742,0 -0.1234023,-0.0583 -0.1186194,-0.0718 -0.2496744,-0.18558 l -0.017219,0.088 q -0.00861,0.0478 -0.026785,0.13679 -0.00861,0.0344 -0.038264,0.0344 -0.034438,0 -0.034438,-0.0421 0,-0.004 0.022958,-0.12245 l 0.017219,-0.089 -0.044004,0.003 q -0.014349,9.5e-4 -0.024872,-0.01 -0.00861,-0.0115 -0.010523,-0.0239 0,-0.0249 0.020089,-0.0344 0.021045,-0.0105 0.072702,-0.0105 l 0.027742,-0.18272 q 0.00765,-0.0287 0.033481,-0.0287 0.039221,0 0.039221,0.0383 0,0.0306 -0.012436,0.10044 l -0.010523,0.067 q 0.095661,0 0.1999309,-0.0411 0.1300986,-0.0516 0.1300986,-0.13584 0,-0.0411 -0.065049,-0.0612 -0.042091,-0.0134 -0.09853,-0.0134 -0.1119231,0 -0.187495,0.0268 l -0.1721893,0.0612 q -0.016262,0 -0.022959,-0.01 -0.0067,-0.0105 -0.00765,-0.0249 -9.566e-4,-0.0239 0.024872,-0.0363 0.077485,-0.0373 0.1760156,-0.0622 0.1061834,-0.0277 0.1836685,-0.0277 0.095661,0 0.1578401,0.0268 0.085138,0.0373 0.085138,0.12053 z m -1.1343246,0.1808 -0.2879388,0.57971 q -0.00957,0.0191 -0.034438,0.0191 -0.010523,0 -0.020089,-0.0105 -0.00957,-0.01 -0.00957,-0.0277 0,-0.0105 0.014349,-0.0392 l 0.1014003,-0.19993 q -0.05644,-0.1454 -0.1061834,-0.22958 l -0.055483,-0.0976 q 0,-0.0344 0.036351,-0.0344 0.021045,0 0.079398,0.10044 0.029655,0.0526 0.046874,0.088 0.019132,0.0392 0.040177,0.0899 l 0.1320118,-0.26307 q 0.0067,-0.0191 0.038264,-0.0191 0.024872,0 0.024872,0.044 z m -0.4439423,0.29464 q 0,0.0134 -0.011479,0.0249 -0.011479,0.0115 -0.024872,0.0115 -0.0239152,0 -0.0344378,-0.0249 -0.0430473,-0.0995 -0.0707889,-0.22768 -0.0124359,-0.0622 -0.022002,-0.14157 -0.007653,-0.0718 -0.007653,-0.13871 -0.0526134,0.0679 -0.10331355,0.15497 l -0.0736587,0.12436 q -0.0277416,0.0478 -0.0344379,0.0497 -0.031568,0 -0.0698323,-0.0966 -0.031568,-0.0794 -0.058353,-0.21332 l -0.0526134,0.089 q -0.0459171,0.0784 -0.0832248,0.16357 -0.0526134,0.11862 -0.0784418,0.22672 -0.003826,0.0163 -0.0133925,0.0211 -0.008609,0.006 -0.0248718,0.006 -0.0105227,0 -0.0239152,-0.009 -0.008609,-0.008 -0.0105227,-0.0239 0,-0.065 0.080355,-0.24011 0.0640927,-0.14062 0.12053247,-0.23437 0.0822682,-0.13583 0.12053249,-0.13583 0.0181755,0 0.0430473,0.14923 0.0172189,0.0995 0.0468738,0.16453 0.0688757,-0.13105 0.16166657,-0.23724 0.0793984,-0.0909 0.10618338,-0.0909 0.0210454,0 0.0210454,0.13966 0,0.10905 0.0248718,0.22959 0.0181755,0.087 0.0468737,0.17793 z m 3.4410035,4.38575 h 0.3968748 v -0.39688 M 0,296.60313 v 0.39688 h 0.39687457 m 4.10103723,-5.29166 h 0.3968748 v 0.39688 M 0,292.10523 v -0.39688 h 0.39687457")
				.build();
	}
}
